<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Sctripts on 李国宝</title><link>https://liguobao.github.io/tags/sctripts/</link><description>Recent content in Sctripts on 李国宝</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 04 Oct 2016 00:00:00 +0000</lastBuildDate><atom:link href="https://liguobao.github.io/tags/sctripts/index.xml" rel="self" type="application/rss+xml"/><item><title>一些有用的脚本</title><link>https://liguobao.github.io/p/%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E7%9A%84%E8%84%9A%E6%9C%AC/</link><pubDate>Tue, 04 Oct 2016 00:00:00 +0000</pubDate><guid>https://liguobao.github.io/p/%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E7%9A%84%E8%84%9A%E6%9C%AC/</guid><description>&lt;h1 id="一些有用的脚本">一些有用的脚本
&lt;/h1>&lt;h2 id="获取电池使用情况报告battery-report-电池历史记录">获取电池使用情况报告(battery-report)-电池历史记录
&lt;/h2>&lt;p>来源：&lt;a class="link" href="http://answers.microsoft.com/zh-hans/windows/wiki/windows_10-performance/%E8%8E%B7%E5%8F%96%E7%94%B5%E6%B1%A0%E4%BD%BF/2d025ee0-8529-45a0-a5ae-46aa5e67f8e8" target="_blank" rel="noopener"
>获取电池使用情况报告(battery-report)-电池历史记录&lt;/a>&lt;/p>
&lt;ol>
&lt;li>点击任务栏搜索框，搜索：POWERSHELL&lt;/li>
&lt;li>鼠标右键点击搜索结果中的“Windows Powershell”，点击“以管理员身份运行”&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-csharp" data-lang="csharp">&lt;span class="line">&lt;span class="cl">&lt;span class="err">$&lt;/span>&lt;span class="n">HTML&lt;/span>&lt;span class="p">=[&lt;/span>&lt;span class="n">System&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Environment&lt;/span>&lt;span class="p">]::&lt;/span>&lt;span class="n">GetFolderPath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="n">Desktop&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="p">)+&lt;/span>&lt;span class="s">&amp;#34;\&amp;#34;+(Get-Date -Format &amp;#39;yyyy-MM-dd&amp;#39;)+&amp;#34;&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="err">电池记录&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">html&lt;/span>&lt;span class="s">&amp;#34;;POWERCFG /BATTERYREPORT /OUTPUT &amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">HTML&lt;/span>&lt;span class="s">&amp;#34;;$TF=Get-Content &amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">HTML&lt;/span>&lt;span class="s">&amp;#34;;$TF| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span> &lt;span class="n">report&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池报告&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">COMPUTER&lt;/span> &lt;span class="n">NAME&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">计算机名&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">SYSTEM&lt;/span> &lt;span class="n">PRODUCT&lt;/span> &lt;span class="n">NAME&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">计算机型号&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">OS&lt;/span> &lt;span class="n">BUILD&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">操作系统内部版本&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">PLATFORM&lt;/span> &lt;span class="n">ROLE&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">平台角色&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">CONNECTED&lt;/span> &lt;span class="n">STANDBY&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="n">InstantGo&lt;/span>&lt;span class="err">（连接待机）&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">REPORT&lt;/span> &lt;span class="n">TIME&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">报告时间&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Installed&lt;/span> &lt;span class="n">batteries&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">已安装的电池&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Information&lt;/span> &lt;span class="n">about&lt;/span> &lt;span class="n">each&lt;/span> &lt;span class="n">currently&lt;/span> &lt;span class="n">installed&lt;/span> &lt;span class="n">battery&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">查看当前已安装电池的信息&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">NAME&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">名称&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">MANUFACTURER&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">制造商&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">SERIAL&lt;/span> &lt;span class="n">NUMBER&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">序列号&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">CHEMISTRY&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">化学成分&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">AT&lt;/span> &lt;span class="n">DESIGN&lt;/span> &lt;span class="n">CAPACITY&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">设计容量时&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">DESIGN&lt;/span> &lt;span class="n">CAPACITY&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">设计容量&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">FULL&lt;/span> &lt;span class="n">CHARGE&lt;/span> &lt;span class="n">CAPACITY&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">完全充电容量&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">CYCLE&lt;/span> &lt;span class="n">COUNT&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">循环计数&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Recent&lt;/span> &lt;span class="n">usage&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">最近使用情况&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Power&lt;/span> &lt;span class="n">states&lt;/span> &lt;span class="n">over&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">last&lt;/span> &lt;span class="m">3&lt;/span> &lt;span class="n">days&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">过去&lt;/span>&lt;span class="m">72&lt;/span>&lt;span class="err">小时内的电源状态&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">START&lt;/span> &lt;span class="n">TIME&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">开始时间&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">STATE&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">状态&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">SOURCE&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电源&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">CAPACITY&lt;/span> &lt;span class="n">REMAINING&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">剩余容量&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span> &lt;span class="n">usage&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池使用情况&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span> &lt;span class="n">drains&lt;/span> &lt;span class="n">over&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">last&lt;/span> &lt;span class="m">3&lt;/span> &lt;span class="n">days&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">过去&lt;/span>&lt;span class="m">72&lt;/span>&lt;span class="err">小时内的电池消耗&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">DURATION&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">使用时间&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">ENERGY&lt;/span> &lt;span class="n">DRAINED&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">消耗的能量&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Usage&lt;/span> &lt;span class="n">history&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">使用历史记录&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">History&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">system&lt;/span> &lt;span class="n">usage&lt;/span> &lt;span class="k">on&lt;/span> &lt;span class="n">AC&lt;/span> &lt;span class="n">and&lt;/span> &lt;span class="n">battery&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">有关交流电源和电池的使用记录&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">BATTERY&lt;/span> &lt;span class="n">DURATION&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池使用时间&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">AC&lt;/span> &lt;span class="n">DURATION&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">交流电源使用时间&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">PERIOD&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">周期&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">ACTIVE&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">活动&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span> &lt;span class="n">capacity&lt;/span> &lt;span class="n">history&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池设计容量历史记录&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Charge&lt;/span> &lt;span class="n">capacity&lt;/span> &lt;span class="n">history&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">the&lt;/span> &lt;span class="n">system&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="n">s&lt;/span> &lt;span class="n">batteries&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池充电能力历史记录&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span> &lt;span class="n">life&lt;/span> &lt;span class="n">estimates&lt;/span> &lt;span class="n">based&lt;/span> &lt;span class="k">on&lt;/span> &lt;span class="n">observed&lt;/span> &lt;span class="n">drains&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">以观察到的消耗情况预计电池寿命&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span> &lt;span class="n">life&lt;/span> &lt;span class="n">estimates&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">预计电池寿命&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">AT&lt;/span> &lt;span class="n">FULL&lt;/span> &lt;span class="n">CHARGE&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">完全充电时&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Current&lt;/span> &lt;span class="n">estimate&lt;/span> &lt;span class="n">of&lt;/span> &lt;span class="n">battery&lt;/span> &lt;span class="n">life&lt;/span> &lt;span class="n">based&lt;/span> &lt;span class="k">on&lt;/span> &lt;span class="n">all&lt;/span> &lt;span class="n">observed&lt;/span> &lt;span class="n">drains&lt;/span> &lt;span class="n">since&lt;/span> &lt;span class="n">OS&lt;/span> &lt;span class="n">install&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">以操作系统安装后所有观察到的消耗记录为基础预计的当前电池寿命&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Since&lt;/span> &lt;span class="n">OS&lt;/span> &lt;span class="n">install&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">从操作系统安装后&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Supported&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">支持&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Not&lt;/span> &lt;span class="n">supported&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">不支持&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">BATTERY&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Suspended&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">已暂停&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Active&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">活动&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Unspecified&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">未知&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Mobile&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">移动&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Desktop&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">桌面&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Workstation&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">工作站&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Report&lt;/span> &lt;span class="n">generated&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">生成当前报告&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">Battery&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">电池&lt;/span>&lt;span class="s">&amp;#34;)}| %{$_.Replace(&amp;#34;&lt;/span>&lt;span class="n">AC&lt;/span>&lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="err">交流电源&lt;/span>&lt;span class="s">&amp;#34;)}|Out-File &amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="n">HTML&lt;/span>&lt;span class="s">&amp;#34;;pause
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>